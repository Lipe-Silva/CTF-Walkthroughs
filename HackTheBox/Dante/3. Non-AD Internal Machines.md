
# 172.16.1.5

## Information Gathering:

```
$ sudo nmap -sS -sV -sC -p 21,111,135,139,445,1433,2049,5985,47001,49664,49665,49666,49673,49677,49678,49679,49680 172.16.1.5
[sudo] password for philip:
Starting Nmap 7.98 ( https://nmap.org ) at 2026-02-07 09:04 -0500
Stats: 0:01:09 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
Service scan Timing: About 93.75% done; ETC: 09:05 (0:00:04 remaining)
Stats: 0:03:17 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 96.97% done; ETC: 09:07 (0:00:04 remaining)
Nmap scan report for 172.16.1.5
Host is up (0.41s latency).

PORT      STATE  SERVICE      VERSION
21/tcp    open   ftp          FileZilla ftpd
| ftp-syst:
|_  SYST: UNIX emulated by FileZilla
| ftp-anon: Anonymous FTP login allowed (FTP code 230)
|_-r--r--r-- 1 ftp ftp             44 Jan 08  2021 flag.txt
111/tcp   open   rpcbind?
| rpcinfo:
|   program version    port/proto  service
|   100003  2,3         2049/udp   nfs
|   100003  2,3         2049/udp6  nfs
|   100003  2,3,4       2049/tcp   nfs
|_  100003  2,3,4       2049/tcp6  nfs
135/tcp   open   msrpc        Microsoft Windows RPC
139/tcp   open   netbios-ssn  Microsoft Windows netbios-ssn
445/tcp   open   microsoft-ds Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
1433/tcp  open   ms-sql-s     Microsoft SQL Server 2019 15.00.2000.00; RTM
| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback
| Not valid before: 2026-02-07T09:13:02
|_Not valid after:  2056-02-07T09:13:02
| ms-sql-info:
|   172.16.1.5\SQLEXPRESS:
|     Instance name: SQLEXPRESS
|     Version:
|       name: Microsoft SQL Server 2019 RTM
|       number: 15.00.2000.00
|       Product: Microsoft SQL Server 2019
|       Service pack level: RTM
|       Post-SP patches applied: false
|     TCP port: 1433
|_    Clustered: false
| ms-sql-ntlm-info:
|   172.16.1.5\SQLEXPRESS:
|     Target_Name: DANTE-SQL01
|     NetBIOS_Domain_Name: DANTE-SQL01
|     NetBIOS_Computer_Name: DANTE-SQL01
|     DNS_Domain_Name: DANTE-SQL01
|     DNS_Computer_Name: DANTE-SQL01
|_    Product_Version: 10.0.14393
|_ssl-date: 2026-02-07T14:04:54+00:00; -38s from scanner time.
2049/tcp  open   nfs          2-4 (RPC #100003)
5985/tcp  open   http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-server-header: Microsoft-HTTPAPI/2.0
|_http-title: Not Found
47001/tcp open   http         Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_http-title: Not Found
|_http-server-header: Microsoft-HTTPAPI/2.0
49664/tcp open   msrpc        Microsoft Windows RPC
49665/tcp open   msrpc        Microsoft Windows RPC
49666/tcp open   msrpc        Microsoft Windows RPC
49673/tcp open   ms-sql-s     Microsoft SQL Server 2019 15.00.2000.00; RTM
| ms-sql-ntlm-info:
|   172.16.1.5:49673:
|     Target_Name: DANTE-SQL01
|     NetBIOS_Domain_Name: DANTE-SQL01
|     NetBIOS_Computer_Name: DANTE-SQL01
|     DNS_Domain_Name: DANTE-SQL01
|     DNS_Computer_Name: DANTE-SQL01
|_    Product_Version: 10.0.14393
|_ssl-date: 2026-02-07T14:04:54+00:00; -39s from scanner time.
| ms-sql-info:
|   172.16.1.5:49673:
|     Version:Microsoft SQL Server 2019
|       name: Microsoft SQL Server 2019 RTM
| rpcinfo:
|   program version    port/proto  service
|   100003  2,3         2049/udp   nfs
|   100003  2,3         2049/udp6  nfs
|   100003  2,3,4       2049/tcp   nf
|       number: 15.00.2000.00
|       Product: Microsoft SQL Server 2019
|       Service pack level: RTM
|       Post-SP patches applied: false
|_    TCP port: 49673
| ssl-cert: Subject: commonName=SSL_Self_Signed_Fallback
| Not valid before: 2026-02-07T09:13:02
|_Not valid after:  2056-02-07T09:13:02
49677/tcp closed unknown
49678/tcp open   msrpc        Microsoft Windows RPC
49679/tcp open   msrpc        Microsoft Windows RPC
49680/tcp open   msrpc        Microsoft Windows RPC
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-time:
|   date: 2026-02-07T14:04:43
|_  start_date: 2026-02-07T09:12:54
| smb2-security-mode:
|   3.1.1:
|_    Message signing enabled but not required
| smb-security-mode:
|   account_used: guest
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_clock-skew: mean: -39s, deviation: 0s, median: -39s
|_nbstat: NetBIOS name: DANTE-SQL01, NetBIOS user: <unknown>, NetBIOS MAC: 00:50:56:b0:64:87 (VMware)

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 257.55 seconds
```

We found a couple of useful things:
- The name of the machine DANTE-SQL01 indicates a DB server
- FTP has anonymous log-on
- port 111 open rpc (2049/tcp open nfs 2-4 (RPC #100003))
- Port 1433 => Microsoft SQL Server 2019 | SQLEXPRESS 10.0.14393
- Port 49673 => Microsoft SQL Server 2019 15.00.2000.00
- HTTP => 5985 | 47001

## Enumeration:

### FTP

Anonymous Login Allowed:
`ftp -a 172.16.1.5`

```
ftp -a 172.16.1.5
Connected to 172.16.1.5.
220 Dante Staff Drop Box
331 Password required for anonymous
230 Logged on
Remote system type is UNIX.
Using binary mode to transfer files.
ftp> ls
229 Entering Extended Passive Mode (|||62054|)
150 Opening data channel for directory listing of "/"
-r--r--r-- 1 ftp ftp             44 Jan 08  2021 flag.txt
226 Successfully transferred "/"
ftp> get flag.txt
local: flag.txt remote: flag.txt

229 Entering Extended Passive Mode (|||60613|)
150 Opening data channel for file download from server of "/flag.txt"
100% |****************************************************************************************************|    44      304.74 KiB/s    00:00 ETA
226 Successfully transferred "/flag.txt"
44 bytes received in 00:00 (103.04 KiB/s)
ftp>
```

Downloaded the following file `flag.txt`
`DANTE{Ther3s_M0r3_to_pwn_so_k33p_searching!}`

### SMB

a
### NFS

a
### MS-SQL

`sqlcmd -S <server_ip_or_hostname> -U <username> -P '<password>'`